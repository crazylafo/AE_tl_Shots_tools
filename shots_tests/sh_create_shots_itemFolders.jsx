var targetName = "SHOT";var shotFolderName = "SHOTS_FX_folder";function findFolderWithName  (name, createIt) {    var create = createIt || undefined;    var item;    var project = app.project;    for(var i=1;i<=project.numItems;i++) {        if (project.item(i) instanceof FolderItem && project.item(i).name === name){            item = project.item(i);            break;        }    }    if (createIt && !item) {        item = project.items.addFolder(name)    }    return item;}function extractMatricule (shot){    var mat = shot.substring (0, shot.lastIndexOf("_"));    mat = mat.substring (mat.indexOf("_")+1);    return mat    }function getShotsList (shotsName){    var shotsList = [];    for (i=1; i<app.project.numItems; i++){        if (app.project.item(i).name.indexOf (shotsName) !=-1 && app.project.item(i) instanceof CompItem ){            var newShot = {};            newShot.name = app.project.item(i).name;            newShot.matricule =extractMatricule (newShot.name);            newShot.id = app.project.item(i).id;            newShot.parentFolder = app.project.item(i).parentFolder;            newShot.groupName = targetName+"_"+newShot.matricule;            shotsList.push (newShot)            }        }    return shotsList     }var shotsList =getShotsList (targetName) ;var shotsFolder =findFolderWithName(shotFolderName, true);app.beginUndoGroup ("create");for (var i=0; i<shotsList.length; i++){    var currShotFodler =  findFolderWithName(shotsList[i].groupName, true);     currShotFodler.parentFolder = shotsFolder;    if (shotsList[i].parentFolder != currShotFodler ){        var shotItem = app.project.itemByID (shotsList[i].id)        shotItem.parentFolder = currShotFodler;        }    currShotFodler.items.addFolder ("ZZ_precomps")        }app.endUndoGroup();