var comp = app.project.activeItem;var sourceName = "SHOTS_";var targetName = "SHOT_";function extractMatricule (shot){    var mat = shot.substring (0, shot.lastIndexOf("_"));    mat = mat.substring (mat.indexOf("_")+1);    return mat    }function extractVersion (shot){    var vers = shot.substr (shot .lastIndexOf("_")+1);    return vers;    }function renameItemFromLayer (layerIndex, newName){    var id = app.project.activeItem.layer(layerIndex).source.id;    var item = app.project.itemByID (id);    item.name = newName;    app.project.activeItem.layer(layerIndex).name = newName;    }if (comp){    app.beginUndoGroup("shot")        for (var i=5; i<= comp.numLayers; i++){        comp.layer(i).name =  comp.layer(i).source.name;        }    for (var i=1; i<= comp.numLayers; i++){        if (comp.layer(i).name.indexOf (sourceName.toString()) !=-1){            var newName = targetName + extractMatricule (comp.layer(i+1).name)+"_"+extractVersion (comp.layer(i).name);            renameItemFromLayer (i, newName)            }        }     app.endundoGroup;  }